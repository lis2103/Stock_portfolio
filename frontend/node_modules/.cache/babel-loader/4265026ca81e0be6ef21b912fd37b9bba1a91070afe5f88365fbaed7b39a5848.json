{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Button,Card,CardHeader}from\"@nextui-org/react\";import{useNavigate}from\"react-router-dom\";import{useUser}from\"./UserContext\";// Import the useUser hook\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Header=()=>{const[totalValue,setTotalValue]=useState(null);const{user,setUserData}=useUser();// Use the user context\nconst navigate=useNavigate();useEffect(()=>{const fetchTotalPortfolioValue=()=>{console.log(\"User object:\",user);if(!user){console.error(\"User ID is not available.\");return;}fetch(\"https://mcsbt-integration-416413.lm.r.appspot.com/\".concat(user.username)).then(response=>{if(!response.ok){throw new Error(\"Failed to fetch portfolio value\");}return response.json();}).then(data=>{setTotalValue(data.total_portfolio_value);}).catch(error=>{console.error(\"Error fetching total portfolio value:\",error);setTotalValue(\"0\");});};// Call fetchTotalPortfolioValue immediately to fetch the initial value\nfetchTotalPortfolioValue();// Set up an interval to fetch the value every 30 seconds\nconst intervalId=setInterval(fetchTotalPortfolioValue,30000);// Clean up the interval when the component unmounts\nreturn()=>clearInterval(intervalId);},[user]);const handleLogout=async()=>{// Optionally make a logout API call to your backend\ntry{const response=await fetch(\"https://mcsbt-integration-416413.lm.r.appspot.com/logout\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\"}});if(!response.ok){// Handle any errors from your API\nthrow new Error(\"Logout failed\");}// Successfully logged out from backend\nconsole.log(\"Logged out successfully\");}catch(error){console.error(error.message);}// Clear the user context\nsetUserData(null);navigate(\"/login\");};return/*#__PURE__*/_jsxs(\"header\",{style:{width:\"100%\",height:\"100px\",backgroundColor:\"black\",position:\"fixed\",top:\"0\",left:\"0\",display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",padding:\"0 20px\",zIndex:1000},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\"},children:/*#__PURE__*/_jsx(Card,{style:{width:\"110px\",backgroundColor:\"WHITE\",color:\"BLACK\"},bordered:true,children:/*#__PURE__*/_jsxs(CardHeader,{className:\"flex-col items-start justify-between\",children:[/*#__PURE__*/_jsx(\"h4\",{style:{color:\"blue\",margin:1,fontWeight:\"bold\"},children:\"Current value\"}),/*#__PURE__*/_jsx(\"small\",{children:totalValue===null?\"Loading...\":\"$\".concat(totalValue)})]})})}),/*#__PURE__*/_jsx(\"h1\",{style:{margin:0,fontWeight:\"900\",color:\"purple\",position:\"absolute\",left:\"50%\",transform:\"translateX(-50%)\",fontSize:\"30px\"},children:\"STOCKS PORTFOLIO\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",color:\"purple\",gap:\"15px\"},children:[user&&/*#__PURE__*/_jsxs(\"span\",{style:{color:\"green\",fontSize:\"20px\"},children:[\"Logged in as \",/*#__PURE__*/_jsx(\"b\",{children:user.username}),\" \"]}),/*#__PURE__*/_jsx(Button,{color:\"default\",auto:true,onClick:handleLogout,children:\"BYE\"})]})]});};export default Header;","map":{"version":3,"names":["React","useState","useEffect","Button","Card","CardHeader","useNavigate","useUser","jsx","_jsx","jsxs","_jsxs","Header","totalValue","setTotalValue","user","setUserData","navigate","fetchTotalPortfolioValue","console","log","error","fetch","concat","username","then","response","ok","Error","json","data","total_portfolio_value","catch","intervalId","setInterval","clearInterval","handleLogout","method","headers","message","style","width","height","backgroundColor","position","top","left","display","justifyContent","alignItems","padding","zIndex","children","color","bordered","className","margin","fontWeight","transform","fontSize","gap","auto","onClick"],"sources":["C:/Users/pante/OneDrive/Έγγραφα/Capestone project/frontend/src/header.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Button, Card, CardHeader } from \"@nextui-org/react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useUser } from \"./UserContext\"; // Import the useUser hook\r\n\r\nconst Header = () => {\r\n  const [totalValue, setTotalValue] = useState(null);\r\n  const { user, setUserData } = useUser(); // Use the user context\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchTotalPortfolioValue = () => {\r\n      console.log(\"User object:\", user);\r\n      if (!user) {\r\n        console.error(\"User ID is not available.\");\r\n        return;\r\n      }\r\n\r\n      fetch(\r\n        `https://mcsbt-integration-416413.lm.r.appspot.com/${user.username}`\r\n      )\r\n        .then((response) => {\r\n          if (!response.ok) {\r\n            throw new Error(\"Failed to fetch portfolio value\");\r\n          }\r\n          return response.json();\r\n        })\r\n        .then((data) => {\r\n          setTotalValue(data.total_portfolio_value);\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Error fetching total portfolio value:\", error);\r\n          setTotalValue(\"0\");\r\n        });\r\n    };\r\n\r\n    // Call fetchTotalPortfolioValue immediately to fetch the initial value\r\n    fetchTotalPortfolioValue();\r\n\r\n    // Set up an interval to fetch the value every 30 seconds\r\n    const intervalId = setInterval(fetchTotalPortfolioValue, 30000);\r\n\r\n    // Clean up the interval when the component unmounts\r\n    return () => clearInterval(intervalId);\r\n  }, [user]);\r\n\r\n  const handleLogout = async () => {\r\n    // Optionally make a logout API call to your backend\r\n    try {\r\n      const response = await fetch(\r\n        \"https://mcsbt-integration-416413.lm.r.appspot.com/logout\",\r\n        {\r\n          method: \"GET\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) {\r\n        // Handle any errors from your API\r\n        throw new Error(\"Logout failed\");\r\n      }\r\n\r\n      // Successfully logged out from backend\r\n      console.log(\"Logged out successfully\");\r\n    } catch (error) {\r\n      console.error(error.message);\r\n    }\r\n\r\n    // Clear the user context\r\n    setUserData(null);\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  return (\r\n    <header\r\n      style={{\r\n        width: \"100%\",\r\n        height: \"100px\",\r\n        backgroundColor: \"black\",\r\n        position: \"fixed\",\r\n        top: \"0\",\r\n        left: \"0\",\r\n        display: \"flex\",\r\n        justifyContent: \"space-between\",\r\n        alignItems: \"center\",\r\n        padding: \"0 20px\",\r\n        zIndex: 1000,\r\n      }}\r\n    >\r\n      <div style={{ display: \"flex\" }}>\r\n        <Card\r\n          style={{ width: \"110px\", backgroundColor: \"WHITE\", color: \"BLACK\" }}\r\n          bordered\r\n        >\r\n          <CardHeader className=\"flex-col items-start justify-between\">\r\n            <h4 style={{ color: \"blue\", margin: 1, fontWeight: \"bold\" }}>\r\n              Current value\r\n            </h4>\r\n            <small>\r\n              {totalValue === null ? \"Loading...\" : `$${totalValue}`}\r\n            </small>\r\n          </CardHeader>\r\n        </Card>\r\n      </div>\r\n\r\n      <h1\r\n        style={{\r\n          margin: 0,\r\n          fontWeight: \"900\",\r\n          color: \"purple\",\r\n          position: \"absolute\",\r\n          left: \"50%\",\r\n          transform: \"translateX(-50%)\",\r\n          fontSize: \"30px\",\r\n        }}\r\n      >\r\n        STOCKS PORTFOLIO\r\n      </h1>\r\n\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          color: \"purple\",\r\n          gap: \"15px\",\r\n        }}\r\n      >\r\n        {user && (\r\n          <span style={{ color: \"green\", fontSize: \"20px\" }}>\r\n            Logged in as <b>{user.username}</b>{\" \"}\r\n            {/* Display the dynamically logged-in username */}\r\n          </span>\r\n        )}\r\n        <Button color=\"default\" auto onClick={handleLogout}>\r\n          BYE\r\n        </Button>\r\n      </div>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}